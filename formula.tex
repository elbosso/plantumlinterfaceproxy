\ifdefined\formula
\else
    \def\formula{E = m c^2}
\fi
\documentclass[border=2pt]{standalone}
\usepackage{amsmath}
\usepackage{varwidth}
\begin{document}
\begin{varwidth}{\linewidth}
\ifdefined\formulaCounter
	\setcounter{equation}{\formulaCounter}
	\begin{align} \formula \end{align}
\else
	\[ \formula \]
\fi
\end{varwidth}
\end{document}